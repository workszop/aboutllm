<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Engineering - Anatomia LLM</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: #fafafa;
            color: #1a1a1a;
            line-height: 1.6;
        }
        nav {
            padding: 1rem 2rem;
            border-bottom: 1px solid #e0e0e0;
            background: #fff;
        }
        nav a { color: #666; text-decoration: none; font-size: 0.9rem; }
        nav a:hover { color: #000; }
        .container { max-width: 1000px; margin: 0 auto; padding: 3rem 2rem; }
        h1 { font-size: 2rem; font-weight: 400; margin-bottom: 1rem; }
        .intro { color: #666; margin-bottom: 3rem; font-size: 1.1rem; }
        .section {
            background: #fff;
            border: 1px solid #e0e0e0;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .section h2 { font-size: 1.1rem; font-weight: 500; margin-bottom: 1.5rem; color: #333; }

        /* Sliders */
        .controls { display: grid; gap: 1.5rem; }
        .control-group {
            display: grid;
            grid-template-columns: 120px 1fr 60px;
            align-items: center;
            gap: 1rem;
        }
        .control-group label { font-weight: 500; font-size: 0.9rem; }
        .control-group input[type="range"] {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: #e0e0e0;
            border-radius: 3px;
            cursor: pointer;
        }
        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #333;
            border-radius: 50%;
            cursor: pointer;
        }
        .control-group .value {
            font-family: monospace;
            font-size: 0.9rem;
            text-align: right;
            color: #666;
        }
        .description {
            font-size: 0.85rem;
            color: #888;
            margin-top: 0.25rem;
            grid-column: 2 / 4;
        }

        /* Probability viz */
        .probability-viz { margin-top: 2rem; }
        .prob-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .prob-header h3 { font-size: 0.95rem; font-weight: 500; }
        .prompt-text {
            font-family: monospace;
            background: #f5f5f5;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            border-radius: 4px;
        }
        .prob-bars { display: flex; flex-direction: column; gap: 8px; }
        .prob-bar { display: flex; align-items: center; gap: 12px; }
        .prob-word { width: 100px; font-size: 0.9rem; text-align: right; }
        .prob-fill-container {
            flex: 1;
            height: 24px;
            background: #f0f0f0;
            position: relative;
            overflow: hidden;
        }
        .prob-fill {
            height: 100%;
            background: #333;
            transition: width 0.3s ease;
        }
        .prob-fill.selected { background: #000; }
        .prob-percent { width: 50px; font-family: monospace; font-size: 0.8rem; color: #666; }

        .output-area { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #eee; }
        .output-area h3 { font-size: 0.95rem; font-weight: 500; margin-bottom: 1rem; }
        .generated-text {
            font-family: monospace;
            background: #f8f8f8;
            padding: 1rem;
            min-height: 100px;
            font-size: 0.9rem;
            line-height: 1.8;
            border: 1px solid #eee;
        }
        .generated-text .word { padding: 2px 4px; border-radius: 2px; cursor: help; }
        .generated-text .word:hover { background: #e8e8e8; }
        button {
            padding: 0.75rem 1.5rem;
            background: #333;
            color: #fff;
            border: none;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:hover { background: #000; }

        /* JSON Editor */
        .json-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .editor-panel h3 { font-size: 0.9rem; margin-bottom: 0.75rem; font-weight: 500; }
        .json-editor {
            width: 100%;
            min-height: 200px;
            font-family: monospace;
            font-size: 0.85rem;
            padding: 1rem;
            border: 1px solid #ddd;
            background: #1a1a1a;
            color: #e0e0e0;
            resize: vertical;
        }
        .json-editor:focus { outline: none; border-color: #666; }
        .json-preview {
            background: #f8f8f8;
            padding: 1rem;
            min-height: 200px;
            font-family: monospace;
            font-size: 0.85rem;
            border: 1px solid #e0e0e0;
            overflow: auto;
        }
        .json-preview.valid { border-color: #0a0; background: #f5fff5; }
        .json-preview.invalid { border-color: #c00; background: #fff5f5; }
        .validation-msg {
            margin-top: 0.5rem;
            padding: 0.5rem;
            font-size: 0.85rem;
            border-radius: 4px;
        }
        .validation-msg.success { background: #e8f5e9; color: #2e7d32; }
        .validation-msg.error { background: #ffebee; color: #c62828; }

        /* Scenarios */
        .scenarios-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .scenario-card {
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
            perspective: 1000px;
        }
        .scenario-card:hover { border-color: #999; transform: translateY(-4px); box-shadow: 0 8px 16px rgba(0,0,0,0.08); }
        .card-inner {
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .scenario-card.flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back {
            padding: 1.5rem;
            min-height: 220px;
            backface-visibility: hidden;
        }
        .card-back {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            transform: rotateY(180deg);
            background: #f8f8f8;
            overflow: auto;
        }
        .scenario-icon {
            width: 48px;
            height: 48px;
            background: #f0f0f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        .scenario-card h3 { font-size: 1rem; margin-bottom: 0.5rem; }
        .scenario-card p { font-size: 0.85rem; color: #666; }
        .card-back h4 { font-size: 0.9rem; margin-bottom: 0.5rem; }
        .card-back ul { font-size: 0.8rem; color: #666; padding-left: 1rem; margin-bottom: 0.75rem; }
        .card-back li { margin-bottom: 0.25rem; }
        .pro { color: #2e7d32; }
        .con { color: #c62828; }

        .explanation {
            background: #f8f8f8;
            padding: 1.5rem;
            margin-top: 2rem;
            border-left: 3px solid #ddd;
        }
        .explanation h3 { font-size: 0.95rem; font-weight: 500; margin-bottom: 0.5rem; }
        .explanation p { font-size: 0.9rem; color: #666; margin-bottom: 0.5rem; }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        .comparison-box {
            padding: 1rem;
            background: #fff;
            border: 1px solid #ddd;
        }
        .comparison-box h4 { font-size: 0.85rem; font-weight: 500; margin-bottom: 0.5rem; }
        .comparison-box p { font-size: 0.8rem; color: #666; }

        @media (max-width: 768px) {
            .control-group { grid-template-columns: 1fr; gap: 0.5rem; }
            .control-group .value { text-align: left; }
            .description { grid-column: 1; }
            .json-grid { grid-template-columns: 1fr; }
            .scenarios-grid { grid-template-columns: 1fr; }
            .comparison { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav><a href="index.html">‚Üê Powr√≥t do strony g≈Ç√≥wnej</a></nav>

    <div class="container">
        <h1>Prompt Engineering</h1>
        <p class="intro">Parametry generowania, struktura odpowiedzi i scenariusze pracy z LLM. Naucz siƒô kontrolowaƒá zachowanie modelu.</p>

        <div class="section">
            <h2>1. Parametry generowania</h2>
            <div class="controls">
                <div class="control-group">
                    <label>Temperature</label>
                    <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7">
                    <span class="value" id="tempValue">0.7</span>
                </div>
                <p class="description">Niska = deterministyczne, Wysoka = kreatywne/losowe</p>

                <div class="control-group">
                    <label>Top-p</label>
                    <input type="range" id="topp" min="0" max="1" step="0.05" value="0.9">
                    <span class="value" id="toppValue">0.9</span>
                </div>
                <p class="description">Nucleus sampling - rozwa≈ºa tokeny sumujƒÖce siƒô do p prawdopodobie≈Ñstwa</p>

                <div class="control-group">
                    <label>Top-k</label>
                    <input type="range" id="topk" min="1" max="50" step="1" value="40">
                    <span class="value" id="topkValue">40</span>
                </div>
                <p class="description">Rozwa≈ºa tylko k najbardziej prawdopodobnych token√≥w</p>

                <div class="control-group">
                    <label>Max tokens</label>
                    <input type="range" id="maxtokens" min="10" max="4096" step="10" value="256">
                    <span class="value" id="maxValue">256</span>
                </div>
                <p class="description">Maksymalna d≈Çugo≈õƒá odpowiedzi w tokenach</p>
            </div>

            <div class="probability-viz">
                <div class="prob-header">
                    <h3>Rozk≈Çad prawdopodobie≈Ñstwa nastƒôpnego s≈Çowa</h3>
                    <span class="prompt-text">Prompt: "S≈Ço≈Ñce ≈õwieci"</span>
                </div>
                <div class="prob-bars" id="probBars"></div>
            </div>

            <div class="output-area">
                <h3>Symulacja generowania</h3>
                <button onclick="generate()">Generuj tekst</button>
                <div class="generated-text" id="generatedText">Kliknij "Generuj tekst" aby zobaczyƒá wynik...</div>
            </div>

            <div class="explanation">
                <h3>Jak dzia≈ÇajƒÖ parametry?</h3>
                <div class="comparison">
                    <div class="comparison-box">
                        <h4>Temperature = 0</h4>
                        <p>Model zawsze wybiera najbardziej prawdopodobny token. Wyniki sƒÖ powtarzalne i precyzyjne, ale mogƒÖ byƒá nudne.</p>
                    </div>
                    <div class="comparison-box">
                        <h4>Temperature = 1+</h4>
                        <p>Rozk≈Çad prawdopodobie≈Ñstwa jest bardziej "p≈Çaski". Model czƒô≈õciej wybiera mniej oczywiste opcje - wiƒôcej kreatywno≈õci, ale ryzyko halucynacji.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>2. Wymuszanie struktury JSON</h2>
            <div class="json-grid">
                <div class="editor-panel">
                    <h3>Prompt z wymaganƒÖ strukturƒÖ</h3>
                    <textarea class="json-editor" id="jsonInput">Zwr√≥ƒá dane u≈ºytkownika w formacie JSON:
{
  "name": "string",
  "age": number,
  "email": "string",
  "interests": ["string"]
}

U≈ºytkownik: Jan Kowalski, 28 lat, jan@example.com, lubi programowanie i szachy</textarea>
                    <button style="margin-top:0.75rem;" onclick="validateAndPreview()">Waliduj i podglƒÖd</button>
                    <div class="validation-msg" id="validationMsg"></div>
                </div>
                <div class="editor-panel">
                    <h3>Symulowana odpowied≈∫ modelu</h3>
                    <div class="json-preview" id="jsonPreview">
{
  "name": "Jan Kowalski",
  "age": 28,
  "email": "jan@example.com",
  "interests": ["programowanie", "szachy"]
}</div>
                </div>
            </div>
            <div class="explanation">
                <p><strong>Structured Output</strong> to technika wymuszania formatu odpowiedzi. Nowoczesne API (OpenAI, Anthropic) oferujƒÖ tryb JSON mode, kt√≥ry gwarantuje poprawny JSON. Mo≈ºna te≈º definiowaƒá schematy (JSON Schema) do walidacji.</p>
            </div>
        </div>

        <div class="section">
            <h2>3. Scenariusze pracy z LLM</h2>
            <p style="color:#666;font-size:0.9rem;margin-bottom:1.5rem;">Kliknij kartƒô, aby zobaczyƒá szczeg√≥≈Çy</p>
            <div class="scenarios-grid">
                <div class="scenario-card" onclick="flipCard(this)">
                    <div class="card-inner">
                        <div class="card-front">
                            <div class="scenario-icon">üí¨</div>
                            <h3>Chat Online</h3>
                            <p>ChatGPT, Claude, Gemini - interfejsy webowe do konwersacji z modelami.</p>
                        </div>
                        <div class="card-back">
                            <h4>Zalety:</h4>
                            <ul>
                                <li class="pro">≈Åatwy dostƒôp, bez konfiguracji</li>
                                <li class="pro">Najnowsze modele</li>
                                <li class="pro">Historia rozm√≥w</li>
                            </ul>
                            <h4>Wady:</h4>
                            <ul>
                                <li class="con">Dane wysy≈Çane do chmury</li>
                                <li class="con">Ograniczona kontrola parametr√≥w</li>
                                <li class="con">Limity u≈ºycia w darmowych planach</li>
                            </ul>
                            <h4>Dla kogo:</h4>
                            <p style="font-size:0.8rem;">Casual users, szybkie pytania, prototypowanie</p>
                        </div>
                    </div>
                </div>

                <div class="scenario-card" onclick="flipCard(this)">
                    <div class="card-inner">
                        <div class="card-front">
                            <div class="scenario-icon">üñ•Ô∏è</div>
                            <h3>Lokalny LLM</h3>
                            <p>Ollama, LM Studio, llama.cpp - modele uruchamiane na w≈Çasnym komputerze.</p>
                        </div>
                        <div class="card-back">
                            <h4>Zalety:</h4>
                            <ul>
                                <li class="pro">Pe≈Çna prywatno≈õƒá danych</li>
                                <li class="pro">Brak koszt√≥w per-token</li>
                                <li class="pro">Pe≈Çna kontrola i customizacja</li>
                            </ul>
                            <h4>Wady:</h4>
                            <ul>
                                <li class="con">Wymaga mocnego GPU (8GB+ VRAM)</li>
                                <li class="con">Mniejsze modele = ni≈ºsza jako≈õƒá</li>
                                <li class="con">Wymaga konfiguracji</li>
                            </ul>
                            <h4>Dla kogo:</h4>
                            <p style="font-size:0.8rem;">Developerzy, firmy z wra≈ºliwymi danymi, enthusiasts</p>
                        </div>
                    </div>
                </div>

                <div class="scenario-card" onclick="flipCard(this)">
                    <div class="card-inner">
                        <div class="card-front">
                            <div class="scenario-icon">{}</div>
                            <h3>API</h3>
                            <p>OpenAI API, Anthropic API, Azure OpenAI - programistyczny dostƒôp do modeli.</p>
                        </div>
                        <div class="card-back">
                            <h4>Zalety:</h4>
                            <ul>
                                <li class="pro">Pe≈Çna kontrola parametr√≥w</li>
                                <li class="pro">Integracja z aplikacjami</li>
                                <li class="pro">Function calling, streaming</li>
                            </ul>
                            <h4>Wady:</h4>
                            <ul>
                                <li class="con">P≈Çatno≈õƒá per-token</li>
                                <li class="con">Wymaga kodu/integracji</li>
                                <li class="con">Rate limits</li>
                            </ul>
                            <h4>Dla kogo:</h4>
                            <p style="font-size:0.8rem;">Developerzy, produkty SaaS, automatyzacja</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="explanation">
            <h3>Best Practices</h3>
            <p><strong>Temperature:</strong> U≈ºyj 0-0.3 dla zada≈Ñ wymagajƒÖcych precyzji (kod, fakty), 0.7-1.0 dla kreatywnych (pisanie, brainstorming).</p>
            <p><strong>Max tokens:</strong> Ustaw rozsƒÖdny limit, aby uniknƒÖƒá zbyt d≈Çugich lub zbyt kosztownych odpowiedzi.</p>
            <p><strong>Structured output:</strong> Zawsze u≈ºywaj JSON mode lub schema validation w produkcji.</p>
        </div>
    </div>

    <script>
        const words = [
            { word: 'jasno', baseProb: 0.35 },
            { word: 'mocno', baseProb: 0.25 },
            { word: 'piƒôknie', baseProb: 0.15 },
            { word: 'dzisiaj', baseProb: 0.10 },
            { word: 'ciep≈Ço', baseProb: 0.08 },
            { word: 'z≈Çoto', baseProb: 0.04 },
            { word: 'magicznie', baseProb: 0.02 },
            { word: 'niezwykle', baseProb: 0.01 }
        ];

        const continuations = {
            low: [
                "jasno i ciep≈Ço dzisiaj.",
                "jasno na niebie.",
                "jasno, wiƒôc wyjdƒô na spacer."
            ],
            medium: [
                "piƒôknie nad miastem, roz≈õwietlajƒÖc ulice z≈Çotym blaskiem.",
                "mocno, a ptaki ≈õpiewajƒÖ w koronach drzew.",
                "jasno dzisiaj - idealny dzie≈Ñ na wycieczkƒô."
            ],
            high: [
                "magicznie, jakby chcia≈Ço nam opowiedzieƒá staro≈ºytnƒÖ historiƒô o z≈Çotych krainach.",
                "niezwykle intensywnie, malujƒÖc ≈õwiat w odcieniach, kt√≥rych nazw jeszcze nie wymy≈õlono.",
                "z≈Çoto i szmaragdowo, a cienie ta≈ÑczƒÖ walca na murach zamku wspomnie≈Ñ."
            ]
        };

        function softmax(logits, temperature) {
            if (temperature === 0) temperature = 0.001;
            const scaled = logits.map(l => l / temperature);
            const maxVal = Math.max(...scaled);
            const exps = scaled.map(s => Math.exp(s - maxVal));
            const sum = exps.reduce((a, b) => a + b, 0);
            return exps.map(e => e / sum);
        }

        function updateVisualization() {
            const temp = parseFloat(document.getElementById('temperature').value);
            const topp = parseFloat(document.getElementById('topp').value);
            const topk = parseInt(document.getElementById('topk').value);
            const maxTok = parseInt(document.getElementById('maxtokens').value);

            document.getElementById('tempValue').textContent = temp.toFixed(1);
            document.getElementById('toppValue').textContent = topp.toFixed(2);
            document.getElementById('topkValue').textContent = topk;
            document.getElementById('maxValue').textContent = maxTok;

            const logits = words.map(w => Math.log(w.baseProb + 0.001));
            const probs = softmax(logits, temp);

            let filteredProbs = probs.map((p, i) => ({ prob: p, idx: i }));
            filteredProbs.sort((a, b) => b.prob - a.prob);
            const topkSet = new Set(filteredProbs.slice(0, topk).map(x => x.idx));

            let cumsum = 0;
            const toppSet = new Set();
            for (const item of filteredProbs) {
                if (cumsum < topp) {
                    toppSet.add(item.idx);
                    cumsum += item.prob;
                }
            }

            const container = document.getElementById('probBars');
            container.innerHTML = '';

            const maxProb = Math.max(...probs);
            words.forEach((word, i) => {
                const isInTopK = topkSet.has(i);
                const isInTopP = toppSet.has(i);
                const isActive = isInTopK && isInTopP;

                const bar = document.createElement('div');
                bar.className = 'prob-bar';
                bar.innerHTML = `
                    <span class="prob-word" style="opacity:${isActive ? 1 : 0.3}">${word.word}</span>
                    <div class="prob-fill-container">
                        <div class="prob-fill ${isActive ? 'selected' : ''}"
                             style="width:${(probs[i] / maxProb) * 100}%;opacity:${isActive ? 1 : 0.2}">
                        </div>
                    </div>
                    <span class="prob-percent">${(probs[i] * 100).toFixed(1)}%</span>
                `;
                container.appendChild(bar);
            });
        }

        function generate() {
            const temp = parseFloat(document.getElementById('temperature').value);
            let category;
            if (temp < 0.5) category = 'low';
            else if (temp < 1.2) category = 'medium';
            else category = 'high';

            const options = continuations[category];
            const text = options[Math.floor(Math.random() * options.length)];

            const container = document.getElementById('generatedText');
            container.innerHTML = '<span style="color:#888">S≈Ço≈Ñce ≈õwieci </span>';

            const wordsArray = text.split(' ');
            let i = 0;
            const interval = setInterval(() => {
                if (i < wordsArray.length) {
                    const span = document.createElement('span');
                    span.className = 'word';
                    span.textContent = wordsArray[i] + ' ';
                    span.title = `Prawdopodobie≈Ñstwo: ${(Math.random() * 30 + 10).toFixed(1)}%`;
                    container.appendChild(span);
                    i++;
                } else {
                    clearInterval(interval);
                }
            }, 150);
        }

        // JSON validation
        function validateAndPreview() {
            const input = document.getElementById('jsonInput').value;
            const preview = document.getElementById('jsonPreview');
            const msg = document.getElementById('validationMsg');

            // Extract JSON-like structure from prompt
            const jsonMatch = input.match(/\{[\s\S]*\}/);

            // Simulate model response
            const response = {
                name: "Jan Kowalski",
                age: 28,
                email: "jan@example.com",
                interests: ["programowanie", "szachy"]
            };

            try {
                const formatted = JSON.stringify(response, null, 2);
                preview.textContent = formatted;
                preview.className = 'json-preview valid';
                msg.textContent = '‚úì JSON poprawny! Odpowied≈∫ zgodna ze schematem.';
                msg.className = 'validation-msg success';
            } catch (e) {
                preview.className = 'json-preview invalid';
                msg.textContent = '‚úó B≈ÇƒÖd walidacji: ' + e.message;
                msg.className = 'validation-msg error';
            }
        }

        // Flip cards
        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        document.getElementById('temperature').addEventListener('input', updateVisualization);
        document.getElementById('topp').addEventListener('input', updateVisualization);
        document.getElementById('topk').addEventListener('input', updateVisualization);
        document.getElementById('maxtokens').addEventListener('input', updateVisualization);

        updateVisualization();
    </script>
</body>
</html>
